<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Aerofriend Chat</title>

  <style>
    :root{
      --bgTop:#0b4f87;
      --bgMid:#083a6d;
      --bgBot:#062a55;

      --text:#fff;
      --muted:rgba(255,255,255,.72);

      --bubble-bot: rgba(255,255,255,.14);
      --bubble-user:#f28a2a;

      --stroke: rgba(255,255,255,.14);

      --input-bg: rgba(255,255,255,.16);
      --input-stroke: rgba(255,255,255,.16);

      --btn-bg: rgba(255,255,255,.10);
      --btn-stroke: rgba(255,255,255,.18);

      --overlay: rgba(0,0,0,.38);
      --panel: rgba(7, 40, 80, .92);
      --panel-stroke: rgba(255,255,255,.14);

      --drawer: rgba(7, 32, 66, .96);

      --radius:18px;

      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);

      --header-h: 88px;
      --composer-h: 92px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      color:var(--text);
      background: radial-gradient(1200px 900px at 35% 25%, var(--bgTop) 0%, var(--bgMid) 45%, var(--bgBot) 100%);
      overflow:hidden;
    }

    .app{ height:100%; display:flex; flex-direction:column; }

    header{
      height: calc(var(--header-h) + var(--safe-top));
      padding: calc(14px + var(--safe-top)) 18px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(0,0,0,.14), rgba(0,0,0,0));
      backdrop-filter: blur(6px);
      position:relative;
      z-index:2;
    }

    .icon-btn{
      width:46px;height:46px;
      border-radius:16px;
      border:1px solid var(--btn-stroke);
      background: var(--btn-bg);
      display:grid;
      place-items:center;
      box-shadow: 0 10px 22px rgba(0,0,0,.18);
      cursor:pointer;
      padding:0;
    }
    .icon-btn img{ width:22px;height:22px; object-fit:contain; display:block; }

    .brand img{ height:22px; width:auto; display:block; }

    .titlebar{ padding: 10px 20px 6px; }
    .titlebar h1{
      margin:0;
      font-size: 40px;
      font-weight: 800;
      letter-spacing:.2px;
      line-height:1.05;
    }

    .chat{
      flex:1;
      display:flex;
      flex-direction:column;
      min-height:0;
      padding: 0 16px;
      position:relative;
    }

    .messages{
      flex:1;
      min-height:0;
      overflow:auto;
      padding: 8px 0 10px;
      -webkit-overflow-scrolling: touch;
      scroll-behavior:smooth;
    }
    .messages::-webkit-scrollbar{ width:8px; }
    .messages::-webkit-scrollbar-thumb{
      background: rgba(255,255,255,.18);
      border-radius: 10px;
    }

    .empty-hint{
      margin: 18px 0 0;
      padding: 14px 14px;
      border: 1px dashed rgba(255,255,255,.18);
      border-radius: 16px;
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.78);
      line-height: 1.35;
    }

    .msg{ margin: 18px 0; display:flex; flex-direction:column; gap:6px; }
    .msg.bot{ align-items:flex-start; }
    .msg.user{ align-items:flex-end; }

    .label{
      font-size: 11px;
      letter-spacing: .6px;
      text-transform: uppercase;
      color: rgba(255,255,255,.55);
      padding: 0 6px;
    }

    .bubble{
      max-width: 78%;
      padding: 14px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--stroke);
      box-shadow: 0 10px 22px rgba(0,0,0,.14);
      backdrop-filter: blur(6px);
      line-height: 1.35;
      font-size: 16px;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .bot .bubble{ background: var(--bubble-bot); border-bottom-left-radius: 10px; }
    .user .bubble{ background: var(--bubble-user); border-color: rgba(255,255,255,.08); border-bottom-right-radius: 10px; }

    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      padding: 0 6px;
      margin-top: 4px;
    }
    .chip{
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
      color: rgba(255,255,255,.92);
      border-radius: 14px;
      padding: 10px 12px;
      font-size: 14px;
      cursor:pointer;
      box-shadow: 0 10px 20px rgba(0,0,0,.12);
      user-select:none;
    }
    .chip:active{ transform: translateY(1px); }

    /* ===== quickbar ===== */
    .quickbar{
      display:flex;
      gap:12px;
      padding: 2px 0 10px;
      align-items:center;
      justify-content:flex-end;
    }
    .pill{
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
      color: rgba(255,255,255,.92);
      border-radius: 999px;
      padding: 10px 14px;
      font-size: 14px;
      cursor:pointer;
      box-shadow: 0 10px 20px rgba(0,0,0,.12);
      display:flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
      user-select:none;
    }
    .pill strong{ font-weight:900; }
    .pill:active{ transform: translateY(1px); }
    .pill.orange{ background: var(--bubble-user); border-color: rgba(255,255,255,.12); color:#fff; font-weight:900; }
    .pill.voice-on{ outline: 2px solid rgba(242,138,42,.55); }

    /* ===== composer ===== */
    .composer{
      height: calc(var(--composer-h) + var(--safe-bottom));
      padding: 12px 16px calc(12px + var(--safe-bottom));
      display:flex;
      align-items:center;
      gap:12px;
      position:relative;
      z-index:1;
    }
    .plus{
      width:54px;height:54px;
      border-radius: 16px;
      border: 1px solid var(--btn-stroke);
      background: rgba(255,255,255,.10);
      display:grid;
      place-items:center;
      box-shadow: 0 10px 22px rgba(0,0,0,.18);
      cursor:pointer;
      padding:0;
    }
    .plus img{ width:22px;height:22px; display:block; }

    .input{
      flex:1;
      height:54px;
      border-radius: 18px;
      border: 1px solid var(--input-stroke);
      background: var(--input-bg);
      color: var(--text);
      outline:none;
      padding: 0 16px;
      font-size: 17px;
      box-shadow: 0 10px 22px rgba(0,0,0,.16);
    }
    .input::placeholder{ color: rgba(255,255,255,.70); }

    .send{
      width:56px;height:54px;
      border-radius: 18px;
      border:none;
      background: var(--bubble-user);
      box-shadow: 0 12px 24px rgba(0,0,0,.22);
      display:grid;
      place-items:center;
      cursor:pointer;
      padding:0;
    }
    .send img{ width:22px;height:22px; display:block; }

    /* ===== popup ===== */
    .overlay{
      position:absolute;
      inset:0;
      background: var(--overlay);
      backdrop-filter: blur(4px);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease;
      z-index:10;
    }
    .overlay.open{ opacity:1; pointer-events:auto; }

    .sheet{
      position:absolute;
      left: 16px;
      right: 16px;
      bottom: calc(var(--composer-h) + 10px + var(--safe-bottom));
      border-radius: 22px;
      border: 1px solid var(--panel-stroke);
      background: var(--panel);
      box-shadow: 0 24px 60px rgba(0,0,0,.28);
      padding: 14px;
      transform: translateY(10px);
      opacity:0;
      transition: transform .18s ease, opacity .18s ease;
    }
    .overlay.open .sheet{ transform: translateY(0); opacity:1; }

    .sheet-title{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      padding: 4px 4px 10px;
    }
    .sheet-title h2{
      margin:0;
      font-size: 28px;
      font-weight: 900;
      letter-spacing:.2px;
      color:#fff;
    }
    .sheet-title p{
      margin:6px 0 0;
      color: rgba(255,255,255,.78);
      font-size: 18px;
      line-height: 1.25;
    }
    .sheet-close{
      width:52px;height:52px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.92);
      cursor:pointer;
      font-size: 30px;
      line-height: 1;
      display:grid;
      place-items:center;
    }

    .actions{ display:grid; grid-template-columns: 1fr; gap:12px; margin-top: 10px; }
    .action-card{
      width:100%;
      text-align:left;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.10);
      border-radius: 22px;
      padding: 16px 16px;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:12px;
      color:#fff;
    }
    .action-card:active{ transform: translateY(1px); }
    .action-main{ display:flex; flex-direction:column; gap:6px; min-width:0; }
    .action-name{ font-weight: 900; font-size: 22px; line-height: 1.1; color:#fff; }
    .action-desc{ font-size: 18px; color: rgba(255,255,255,.78); line-height: 1.2; }

    /* ===== Drawer ===== */
    .drawerOverlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.42);
      backdrop-filter: blur(4px);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease;
      z-index:30;
    }
    .drawerOverlay.open{ opacity:1; pointer-events:auto; }

    .drawer{
      position:absolute;
      top:0; left:0;
      height:100%;
      width:min(360px, 86vw);
      padding: calc(18px + var(--safe-top)) 16px calc(16px + var(--safe-bottom));
      background: var(--drawer);
      border-right: 1px solid rgba(255,255,255,.12);
      box-shadow: 18px 0 40px rgba(0,0,0,.30);
      transform: translateX(-10px);
      opacity:0;
      transition: transform .18s ease, opacity .18s ease;
      display:flex;
      flex-direction:column;
      gap:14px;
    }
    .drawerOverlay.open .drawer{
      transform: translateX(0);
      opacity:1;
    }

    .drawerTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding-bottom: 6px;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .drawerTitle{
      font-size: 20px;
      font-weight: 900;
      letter-spacing:.2px;
    }
    .drawerClose{
      width:44px;height:44px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:#fff;
      font-size: 28px;
      line-height: 1;
      cursor:pointer;
      display:grid;
      place-items:center;
    }

    .nav{
      display:flex;
      flex-direction:column;
      gap:10px;
      padding-top: 6px;
    }
    .navItem{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      border-radius: 18px;
      padding: 14px 14px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      color:#fff;
      user-select:none;
    }
    .navItem.active{
      background: rgba(242,138,42,.20);
      border-color: rgba(242,138,42,.40);
    }
    .navItem .name{
      font-size: 16px;
      font-weight: 900;
    }
    .navItem .sub{
      font-size: 13px;
      color: rgba(255,255,255,.70);
      margin-top: 3px;
    }

    .drawerFooter{
      margin-top:auto;
      border-top: 1px solid rgba(255,255,255,.10);
      padding-top: 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .langRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .langBtn{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:#fff;
      border-radius: 999px;
      padding: 10px 12px;
      cursor:pointer;
      font-weight: 800;
      font-size: 13px;
    }
    .langBtn.active{
      background: rgba(242,138,42,.22);
      border-color: rgba(242,138,42,.42);
    }

    @media (min-width: 820px) and (orientation: landscape){
      .app{ align-items:center; }
      header,.titlebar,.chat,.composer{ width: min(920px, 92vw); }
      .bubble{ max-width: 62%; }
      .titlebar h1{ font-size: 44px; }
      .sheet{ left: 0; right: 0; }
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <button id="burger" class="icon-btn" type="button" aria-label="Menu">
        <img src="Icon/Burger-menu.svg" alt="" />
      </button>

      <div class="brand" aria-label="Aeroflot">
        <img src="Logo/CMYK.svg" alt="AEROFLOT" />
      </div>
    </header>

    <div class="titlebar">
      <h1 id="titleH1">–ê—ç—Ä–æ–¥—Ä—É–≥</h1>
    </div>

    <main class="chat">
      <div id="messages" class="messages" role="log" aria-live="polite" aria-relevant="additions">
        <div id="emptyHint" class="empty-hint"></div>
      </div>

      <div class="quickbar" aria-label="Quick actions">
        <button id="crewBtnFixed" class="pill orange" type="button"></button>
        <button id="voiceBtn" class="pill" type="button"></button>
      </div>

      <div id="overlay" class="overlay" aria-hidden="true">
        <div class="sheet" role="dialog" aria-label="Quick scenarios">
          <div class="sheet-title">
            <div>
              <h2 id="sheetTitle">–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å –≤ –ø–æ–ª—ë—Ç–µ</h2>
              <p id="sheetSubtitle">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π ‚Äî —è –∑–∞–¥–∞–º –ø–∞—Ä—É –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂—É –≤–∞—Ä–∏–∞–Ω—Ç.</p>
            </div>
            <button id="closeSheet" class="sheet-close" type="button" aria-label="Close">√ó</button>
          </div>

          <div class="actions">
            <button class="action-card" type="button" data-action="watch">
              <div class="action-main">
                <div class="action-name" id="actWatchName">üé¨ –ü–æ–¥–±–æ—Ä–∫–∞ –Ω–∞ —ç—Ç–æ—Ç —Ä–µ–π—Å</div>
                <div class="action-desc" id="actWatchDesc">–§–∏–ª—å–º –∏–ª–∏ —Å–µ—Ä–∏–∞–ª –ø–æ–¥ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—ë—Ç–∞ –∏ –≤–∫—É—Å.</div>
              </div>
            </button>

            <button class="action-card" type="button" data-action="sleep">
              <div class="action-main">
                <div class="action-name" id="actSleepName">üåô –ú—è–≥–∫–æ —É—Å–Ω—É—Ç—å</div>
                <div class="action-desc" id="actSleepDesc">–î—ã—Ö–∞–Ω–∏–µ, —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ –∏ ‚Äú–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã‚Äù.</div>
              </div>
            </button>

            <button class="action-card" type="button" data-action="flyover">
              <div class="action-main">
                <div class="action-name" id="actFlyName">üó∫Ô∏è –ú–∞—Ä—à—Ä—É—Ç –∏ –≥–¥–µ –º—ã</div>
                <div class="action-desc" id="actFlyDesc">–ì–æ—Ä–æ–¥–∞ –ø–æ –º–∞—Ä—à—Ä—É—Ç—É –∏ —á—Ç–æ –ø–æ–¥ –Ω–∞–º–∏ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.</div>
              </div>
            </button>

            <button class="action-card" type="button" data-action="aircraft">
              <div class="action-main">
                <div class="action-name" id="actAirName">‚úàÔ∏è –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –æ —Å–∞–º–æ–ª—ë—Ç–µ</div>
                <div class="action-desc" id="actAirDesc">–§–∞–∫—Ç—ã –ø—Ä–æ –ø–æ–ª—ë—Ç, –≤—ã—Å–æ—Ç—É, —Å–∫–æ—Ä–æ—Å—Ç—å –∏ —Ç—É—Ä–±—É–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å.</div>
              </div>
            </button>
          </div>
        </div>
      </div>

      <div class="composer">
        <button id="plus" class="plus" type="button" aria-label="Scenarios">
          <img src="Icon/Plus.svg" alt="" />
        </button>

        <input id="input" class="input" type="text" autocomplete="off" />

        <button id="send" class="send" type="button" aria-label="Send">
          <img src="Icon/TextButton/arrow-up_20x20.svg" alt="" />
        </button>
      </div>
    </main>
  </div>

  <!-- Drawer -->
  <div id="drawerOverlay" class="drawerOverlay" aria-hidden="true">
    <aside class="drawer" role="dialog" aria-label="Navigation">
      <div class="drawerTop">
        <div class="drawerTitle" id="drawerTitle">–ù–∞–≤–∏–≥–∞—Ü–∏—è</div>
        <button id="drawerClose" class="drawerClose" type="button" aria-label="Close">√ó</button>
      </div>

      <nav class="nav">
        <div class="navItem active" data-page="aerofriend">
          <div>
            <div class="name" id="navAerofriend">–ê—ç—Ä–æ–¥—Ä—É–≥</div>
            <div class="sub" id="navAerofriendSub">–ß–∞—Ç-–ø–æ–º–æ—â–Ω–∏–∫ –≤ –ø–æ–ª—ë—Ç–µ</div>
          </div>
        </div>

        <div class="navItem" data-page="entertainment">
          <div>
            <div class="name" id="navEntertainment">–¶–µ–Ω—Ç—Ä —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π</div>
            <div class="sub" id="navEntertainmentSub">–§–∏–ª—å–º—ã, –º—É–∑—ã–∫–∞, –∏–≥—Ä—ã</div>
          </div>
        </div>

        <div class="navItem" data-page="map3d">
          <div>
            <div class="name" id="navMap3d">3D-–∫–∞—Ä—Ç–∞</div>
            <div class="sub" id="navMap3dSub">–ú–∞—Ä—à—Ä—É—Ç –≤ –æ–±—ä—ë–º–µ</div>
          </div>
        </div>
      </nav>

      <div class="drawerFooter">
        <div id="langTitle" style="font-weight:900; letter-spacing:.2px;">–Ø–∑—ã–∫</div>
        <div class="langRow">
          <button class="langBtn" data-lang="ru">–†—É—Å—Å–∫–∏–π</button>
          <button class="langBtn" data-lang="en">English</button>
          <button class="langBtn" data-lang="tr">T√ºrk√ße</button>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // =========================
    // i18n
    // =========================
    const I18N = {
      ru: {
        appTitle: "–ê—ç—Ä–æ–¥—Ä—É–≥",
        emptyHint: "–ù–∞–∂–º–∏—Ç–µ ¬´+¬ª –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å ‚Äî —è –ø–æ–º–æ–≥—É –ø–æ —Ö–æ–¥—É –ø–æ–ª—ë—Ç–∞.",
        placeholder: "–°–ø—Ä–æ—Å–∏ –º–µ–Ω—è",
        drawerTitle: "–ù–∞–≤–∏–≥–∞—Ü–∏—è",
        nav: {
          aerofriend: { name: "–ê—ç—Ä–æ–¥—Ä—É–≥", sub: "–ß–∞—Ç-–ø–æ–º–æ—â–Ω–∏–∫ –≤ –ø–æ–ª—ë—Ç–µ" },
          entertainment: { name: "–¶–µ–Ω—Ç—Ä —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π", sub: "–§–∏–ª—å–º—ã, –º—É–∑—ã–∫–∞, –∏–≥—Ä—ã" },
          map3d: { name: "3D-–∫–∞—Ä—Ç–∞", sub: "–ú–∞—Ä—à—Ä—É—Ç –≤ –æ–±—ä—ë–º–µ" }
        },
        langTitle: "–Ø–∑—ã–∫",
        sheetTitle: "–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å –≤ –ø–æ–ª—ë—Ç–µ",
        sheetSubtitle: "–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π ‚Äî —è –∑–∞–¥–∞–º –ø–∞—Ä—É –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂—É –≤–∞—Ä–∏–∞–Ω—Ç.",
        actions: {
          watchName:"üé¨ –ü–æ–¥–±–æ—Ä–∫–∞ –Ω–∞ —ç—Ç–æ—Ç —Ä–µ–π—Å",
          watchDesc:"–§–∏–ª—å–º –∏–ª–∏ —Å–µ—Ä–∏–∞–ª –ø–æ–¥ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—ë—Ç–∞ –∏ –≤–∫—É—Å.",
          sleepName:"üåô –ú—è–≥–∫–æ —É—Å–Ω—É—Ç—å",
          sleepDesc:"–î—ã—Ö–∞–Ω–∏–µ, —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ –∏ ‚Äú–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã‚Äù.",
          flyName:"üó∫Ô∏è –ú–∞—Ä—à—Ä—É—Ç –∏ –≥–¥–µ –º—ã",
          flyDesc:"–ì–æ—Ä–æ–¥–∞ –ø–æ –º–∞—Ä—à—Ä—É—Ç—É –∏ —á—Ç–æ –ø–æ–¥ –Ω–∞–º–∏ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.",
          airName:"‚úàÔ∏è –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –æ —Å–∞–º–æ–ª—ë—Ç–µ",
          airDesc:"–§–∞–∫—Ç—ã –ø—Ä–æ –ø–æ–ª—ë—Ç, –≤—ã—Å–æ—Ç—É, —Å–∫–æ—Ä–æ—Å—Ç—å –∏ —Ç—É—Ä–±—É–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å."
        },
        quick: {
          crew: "–°–≤—è–∑—å —Å –±–æ—Ä—Ç–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–æ–º",
          voice: "üéôÔ∏è –ü–æ–≥–æ–≤–æ—Ä–∏—Ç—å",
          voiceStop: "‚èπÔ∏è –°—Ç–æ–ø –∑–∞–ø–∏—Å—å"
        },
        errors: {
          pickList: "–ü—Ä–æ—Å—Ç–∏—Ç–µ, –Ω–µ –ø–æ–Ω—è–ª, —á—Ç–æ –≤—ã –∏–º–µ–ª–∏ –≤–≤–∏–¥—É. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞"
        },
        mainMenu: [
          {label:"üé¨ –ü–æ–¥–±–æ—Ä–∫–∞ –Ω–∞ —Ä–µ–π—Å", value:"start:watch"},
          {label:"üåô –ú—è–≥–∫–æ —É—Å–Ω—É—Ç—å", value:"start:sleep"},
          {label:"üó∫Ô∏è –ú–∞—Ä—à—Ä—É—Ç –∏ –≥–¥–µ –º—ã", value:"start:flyover"},
          {label:"‚úàÔ∏è –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –æ —Å–∞–º–æ–ª—ë—Ç–µ", value:"start:aircraft"},
          {label:"–°–≤—è–∑—å —Å –±–æ—Ä—Ç–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–æ–º", value:"start:crew"},
        ],
        smalltalk: {
          hello: "–ü—Ä–∏–≤–µ—Ç. –Ø –ê—ç—Ä–æ–¥—Ä—É–≥. –ù–∞–∂–º–∏—Ç–µ ‚Äú+‚Äù –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏–ª–∏ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å.",
          thanks: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞. –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å."
        },
        watch: {
          askDuration: "–ü–æ–¥–±–µ—Ä—É, —á—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å. –°–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–Ω–æ –ª–µ—Ç–µ—Ç—å? –ú–æ–∂–Ω–æ ‚Äú2:30‚Äù –∏–ª–∏ ‚Äú150 –º–∏–Ω—É—Ç‚Äù.",
          askGenre: "–û–∫–µ–π. –ö–∞–∫–æ–π –∂–∞–Ω—Ä –±–µ—Ä—ë–º?",
          askFormat: "–§–æ—Ä–º–∞—Ç: —Å–µ—Ä–∏–∞–ª –∏–ª–∏ —Ñ–∏–ª—å–º?",
          refineChips: [
            {label:"–ü–æ–ª–µ–≥—á–µ", value:"watch:lighter"},
            {label:"–ü–æ–∂—ë—Å—Ç—á–µ", value:"watch:harder"},
            {label:"–°–º–µ–Ω–∏—Ç—å –∂–∞–Ω—Ä", value:"watch:genre"}
          ],
          durationChips: [
            {label:"–î–æ 1 —á–∞—Å–∞", value:"~1h"},
            {label:"1‚Äì2 —á–∞—Å–∞", value:"~1-2h"},
            {label:"2‚Äì4 —á–∞—Å–∞", value:"~2-4h"},
            {label:"–ë–æ–ª—å—à–µ 4 —á–∞—Å–æ–≤", value:"~4+h"}
          ],
          genreChips: [
            {label:"–ö–æ–º–µ–¥–∏—è", value:"genre:comedy"},
            {label:"–î–µ—Ç–µ–∫—Ç–∏–≤/—Ç—Ä–∏–ª–ª–µ—Ä", value:"genre:detective"},
            {label:"–î—Ä–∞–º–∞", value:"genre:drama"},
            {label:"–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", value:"genre:scifi"}
          ],
          formatChips: [
            {label:"–°–µ—Ä–∏–∞–ª", value:"format:series"},
            {label:"–§–∏–ª—å–º", value:"format:film"}
          ],
          bucketName: (b)=> b==="short"?"–∫–æ—Ä–æ—Ç–∫–∏–π":(b==="mid"?"—Å—Ä–µ–¥–Ω–∏–π":"–¥–ª–∏–Ω–Ω—ã–π"),
          picksLabel: (bucket)=>`–ü–æ–¥–±–æ—Ä–∫–∞ (${bucket} —Å–ª–æ—Ç):`
        },
        sleep: {
          intro: "–°–¥–µ–ª–∞–µ–º —Å–ø–æ–∫–æ–π–Ω—ã–π ‚Äú—Å–ø—É—Å–∫‚Äù –≤ —Å–æ–Ω. –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –µ—Å—Ç—å?",
          chips: [
            {label:"5 –º–∏–Ω—É—Ç", value:"sleep:5"},
            {label:"10 –º–∏–Ω—É—Ç", value:"sleep:10"},
            {label:"–ü—Ä–æ—Å—Ç–æ —Å–æ–≤–µ—Ç—ã", value:"sleep:tips"}
          ],
          tips: "–°–æ–≤–µ—Ç—ã –¥–ª—è —Å–Ω–∞:\n‚Ä¢ –ú–∞—Å–∫–∞/–±–µ—Ä—É—à–∏\n‚Ä¢ –ü–ª–µ–¥ –ø–æ–¥ –ø–æ—è—Å–Ω–∏—Ü—É\n‚Ä¢ –í–æ–¥–∞ –Ω–µ–±–æ–ª—å—à–∏–º–∏ –≥–ª–æ—Ç–∫–∞–º–∏\n\n–ï—Å–ª–∏ –≤—ã —É –æ–∫–Ω–∞/–ø—Ä–æ—Ö–æ–¥–∞ ‚Äî —Å–∫–∞–∂–∏—Ç–µ, –ø–æ–¥—Å–∫–∞–∂—É –ø–æ–∑—É.",
          five: "5 –º–∏–Ω—É—Ç:\n1) –í–¥–æ—Ö 4 —Å–µ–∫—É–Ω–¥—ã\n2) –í—ã–¥–æ—Ö 6 —Å–µ–∫—É–Ω–¥\n–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ 8 —Ü–∏–∫–ª–æ–≤.\n\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –µ—â—ë 2 –º–∏–Ω—É—Ç—ã?",
          fiveChips: [
            {label:"–î–∞, –µ—â—ë 2", value:"sleep:more2"},
            {label:"–ù–µ—Ç, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ", value:"sleep:done"}
          ],
          more2: "–ï—â—ë 2 –º–∏–Ω—É—Ç—ã:\n–í–¥–æ—Ö 4 ‚Äî –≤—ã–¥–æ—Ö 8.\n–ï—Å–ª–∏ —Å–±–∏–ª–∏—Å—å ‚Äî —Å–ø–æ–∫–æ–π–Ω–æ –Ω–∞—á–Ω–∏—Ç–µ –∑–∞–Ω–æ–≤–æ.\n\n–ì–æ—Ç–æ–≤–æ.",
          done: "–û–∫–µ–π. –ï—Å–ª–∏ –º—ã—Å–ª–∏ –º–µ—à–∞—é—Ç ‚Äî —Å—á–∏—Ç–∞–π—Ç–µ –≤—ã–¥–æ—Ö–∏ –æ—Ç 1 –¥–æ 20 –∏ —Å–Ω–æ–≤–∞ —Å 1.",
          tenAsk: "10 –º–∏–Ω—É—Ç: —Ö–æ—Ç–∏—Ç–µ ‚Äú—Ç–æ–ª—å–∫–æ —Ç–∞–π–º–∏–Ω–≥‚Äù –∏–ª–∏ ‚Äú—Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏‚Äù?",
          tenChips: [
            {label:"–¢–æ–ª—å–∫–æ —Ç–∞–π–º–∏–Ω–≥", value:"sleep:timing"},
            {label:"–° –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏", value:"sleep:coach"}
          ],
          askStart: "–°–∫–∞–∂–∏—Ç–µ ‚Äú—Å—Ç–∞—Ä—Ç‚Äù. –Ø –ø—Ä–æ–≤–µ–¥—É –ø–æ —ç—Ç–∞–ø–∞–º –∫–æ—Ä–æ—Ç–∫–∏–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.",
          startNeed: "–ù–∞–ø–∏—à–∏—Ç–µ ‚Äú—Å—Ç–∞—Ä—Ç‚Äù.",
          start1: "–°—Ç–∞—Ä—Ç. 2 –º–∏–Ω—É—Ç—ã: –≤–¥–æ—Ö 4 ‚Äî –≤—ã–¥–æ—Ö 6.",
          start2: "–î–∞–ª—å—à–µ. 3 –º–∏–Ω—É—Ç—ã: —Ä–∞—Å—Å–ª–∞–±—å—Ç–µ –ª–æ–± ‚Üí –≥–ª–∞–∑–∞ ‚Üí —á–µ–ª—é—Å—Ç—å ‚Üí –ø–ª–µ—á–∏ ‚Üí —Ä—É–∫–∏.",
          start3: "–§–∏–Ω–∞–ª. 5 –º–∏–Ω—É—Ç: –ø—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ ‚Äú—Ç–∏—Ö–∏–π –∫–æ—Ä–∏–¥–æ—Ä‚Äù, –∫–∞–∂–¥—ã–π —à–∞–≥ ‚Äî –≤—ã–¥–æ—Ö.",
          startDone: "–ì–æ—Ç–æ–≤–æ."
        },
        fly: {
          menu: "–ú–æ–≥—É –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –º–∞—Ä—à—Ä—É—Ç—É –∏–ª–∏ —Å–∫–∞–∑–∞—Ç—å, –≥–¥–µ –º—ã —Å–µ–π—á–∞—Å.",
          chips: [
            {label:"–ö–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞ –ø—Ä–æ–ª–µ—Ç–∞–µ–º", value:"fly:list"},
            {label:"–ß—Ç–æ –º—ã –ø—Ä–æ–ª–µ—Ç–∞–µ–º —Å–µ–π—á–∞—Å", value:"fly:now"}
          ],
          routeTitle:"–ú–∞—Ä—à—Ä—É—Ç:",
          nowChips: [
            {label:"–ê –≥–¥–µ –º—ã?", value:"fly:now"},
            {label:"–ö–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞ –ø–æ –º–∞—Ä—à—Ä—É—Ç—É", value:"fly:list"}
          ],
          listAfter: [
            {label:"–ß—Ç–æ –º—ã –ø—Ä–æ–ª–µ—Ç–∞–µ–º —Å–µ–π—á–∞—Å", value:"fly:now"}
          ],
          weOver: (city)=>`–ú—ã –Ω–∞–¥ ${city}.`
        },
        aircraft: {
          intro:"–ö–æ—Ä–æ—Ç–∫–∏–π —Ñ–∞–∫—Ç: –Ω–∞ –∫—Ä–µ–π—Å–µ—Ä—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –ª–∞–π–Ω–µ—Ä –æ–±—ã—á–Ω–æ –ª–µ—Ç–∏—Ç –Ω–∞ –≤—ã—Å–æ—Ç–µ –æ–∫–æ–ª–æ 10‚Äì12 –∫–º.",
          chips:[
            {label:"–ï—â—ë —Ñ–∞–∫—Ç", value:"air:more"},
            {label:"–ü—Ä–æ —Å–∫–æ—Ä–æ—Å—Ç—å", value:"air:speed"},
            {label:"–ü—Ä–æ —Ç—É—Ä–±—É–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å", value:"air:turb"}
          ],
          speed:"–ö—Ä–µ–π—Å–µ—Ä—Å–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —É –ª–∞–π–Ω–µ—Ä–æ–≤ –æ–±—ã—á–Ω–æ –ø–æ—Ä—è–¥–∫–∞ 800‚Äì900 –∫–º/—á. –í–µ—Ç–µ—Ä –º–æ–∂–µ—Ç –∑–∞–º–µ—Ç–Ω–æ –º–µ–Ω—è—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å ‚Äú–ø–æ –∑–µ–º–ª–µ‚Äù.",
          turb:"–ï—Å–ª–∏ —Ç—Ä—è—Å—ë—Ç: —Ä–µ–º–µ–Ω—å –ø—Ä–∏—Å—Ç—ë–≥–Ω—É—Ç. –≠–∫–∏–ø–∞–∂ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å —ç—à–µ–ª–æ–Ω –∏ –æ–±—Ö–æ–¥–∏—Ç—å –∑–æ–Ω—ã –ø–æ –ø–æ–≥–æ–¥–µ –∏ –¥–æ–∫–ª–∞–¥–∞–º.",
          facts:[
            "–í —Å–∞–ª–æ–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–∞–≤–ª–µ–Ω–∏–µ, —á—Ç–æ–±—ã –±—ã–ª–æ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –¥—ã—à–∞—Ç—å –Ω–∞ –≤—ã—Å–æ—Ç–µ.",
            "–ó–∞–∫—Ä—ã–ª–∫–∏ –∏ –ø—Ä–µ–¥–∫—Ä—ã–ª–∫–∏ –ø–æ–º–æ–≥–∞—é—Ç –ª–µ—Ç–∞—Ç—å –Ω–∞ –º–µ–Ω—å—à–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–∏ –≤–∑–ª—ë—Ç–µ –∏ –ø–æ—Å–∞–¥–∫–µ.",
            "–ü—Ä–∏ –ø–æ—Å–∞–¥–∫–µ —Å–∞–º–æ–ª—ë—Ç –º–µ–Ω—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫—Ä—ã–ª–∞ ‚Äî –ø–æ—ç—Ç–æ–º—É —Å–ª—ã—à–Ω—ã —â–µ–ª—á–∫–∏ –∏ —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è —à—É–º –≤–æ–∑–¥—É—Ö–∞."
          ]
        },
        crew: {
          ask:"–ß—Ç–æ –ø–µ—Ä–µ–¥–∞—Ç—å –±–æ—Ä—Ç–ø—Ä–æ–≤–æ–¥–Ω–∏–∫—É?",
          options:[
            {label:"–ü—Ä–∏–Ω–µ—Å–∏—Ç–µ –≤–æ–¥—É", value:"crew:water"},
            {label:"–ù—É–∂–Ω–∞ –ø–æ–¥—É—à–∫–∞", value:"crew:pillow"},
            {label:"–ó–∞–∫–∞–∂–∏—Ç–µ —É–∂–∏–Ω", value:"crew:dinner"},
            {label:"–ü—Ä–∏–Ω–µ—Å–∏—Ç–µ –¥–µ—Ç—Å–∫–æ–µ –º–µ–Ω—é", value:"crew:kids"}
          ],
          accepted:(phrase)=>`–ü—Ä–∏–Ω—è—Ç–æ: ¬´${phrase}¬ª. –•–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —á—Ç–æ-—Ç–æ –µ—â—ë?`,
          after:[
            {label:"–ï—â—ë –∑–∞–ø—Ä–æ—Å", value:"crew:more"},
            {label:"–ì–æ—Ç–æ–≤–æ", value:"crew:done"}
          ],
          ok:"–•–æ—Ä–æ—à–æ."
        },
        voice: {
          recording:"–ó–∞–ø–∏—Å—ã–≤–∞—é. –ù–∞–∂–º–∏—Ç–µ ‚Äú–°—Ç–æ–ø‚Äù, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–µ.",
          gotVoice:"–ü—Ä–∏–Ω—è–ª –≥–æ–ª–æ—Å–æ–≤–æ–µ. –î–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –Ω–∞–ø–∏—à–∏—Ç–µ –∫–æ—Ä–æ—Ç–∫–æ —Ç–µ–∫—Å—Ç–æ–º –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π –∫–Ω–æ–ø–∫–æ–π ‚Äú+‚Äù.",
          noSupport:"–ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–æ–≤—ã—Ö –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ. –ú–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–º.",
          micFail:"–ù–µ —É–¥–∞–ª–æ—Å—å –≤–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞."
        }
      },

      en: {
        appTitle: "Aerofriend",
        emptyHint: "Tap ‚Äú+‚Äù for scenarios or type a question ‚Äî I‚Äôll help during the flight.",
        placeholder: "Ask me",
        drawerTitle: "Navigation",
        nav: {
          aerofriend: { name: "Aerofriend", sub: "In-flight chat assistant" },
          entertainment: { name: "Entertainment Center", sub: "Movies, music, games" },
          map3d: { name: "3D Map", sub: "Route in 3D" }
        },
        langTitle: "Language",
        sheetTitle: "What to do in flight",
        sheetSubtitle: "Choose a scenario ‚Äî I‚Äôll ask a couple of questions and suggest an option.",
        actions: {
          watchName:"üé¨ Something to watch",
          watchDesc:"Movie/series based on flight time and taste.",
          sleepName:"üåô Fall asleep gently",
          sleepDesc:"Breathing and relaxation to switch off.",
          flyName:"üó∫Ô∏è Route & where we are",
          flyDesc:"Cities on the route and where we are right now.",
          airName:"‚úàÔ∏è Aircraft facts",
          airDesc:"Altitude, speed, turbulence ‚Äî quick explanations."
        },
        quick: {
          crew: "Contact cabin crew",
          voice: "üéôÔ∏è Talk",
          voiceStop: "‚èπÔ∏è Stop recording"
        },
        errors: {
          pickList: "Sorry, I didn‚Äôt understand. Please choose from the list."
        },
        mainMenu: [
          {label:"üé¨ Watch picks", value:"start:watch"},
          {label:"üåô Sleep help", value:"start:sleep"},
          {label:"üó∫Ô∏è Route & location", value:"start:flyover"},
          {label:"‚úàÔ∏è Aircraft facts", value:"start:aircraft"},
          {label:"Contact cabin crew", value:"start:crew"},
        ],
        smalltalk: {
          hello: "Hi. I‚Äôm Aerofriend. Tap ‚Äú+‚Äù for scenarios or tell me what you need.",
          thanks: "You‚Äôre welcome. Pick a scenario or ask a question."
        },
        watch: {
          askDuration: "I can recommend something to watch. How long is your flight? You can type ‚Äú2:30‚Äù or ‚Äú150 minutes‚Äù.",
          askGenre: "Got it. Which genre?",
          askFormat: "Format: series or movie?",
          refineChips: [
            {label:"Lighter", value:"watch:lighter"},
            {label:"More intense", value:"watch:harder"},
            {label:"Change genre", value:"watch:genre"}
          ],
          durationChips: [
            {label:"Up to 1 hour", value:"~1h"},
            {label:"1‚Äì2 hours", value:"~1-2h"},
            {label:"2‚Äì4 hours", value:"~2-4h"},
            {label:"4+ hours", value:"~4+h"}
          ],
          genreChips: [
            {label:"Comedy", value:"genre:comedy"},
            {label:"Mystery/Thriller", value:"genre:detective"},
            {label:"Drama", value:"genre:drama"},
            {label:"Sci-fi", value:"genre:scifi"}
          ],
          formatChips: [
            {label:"Series", value:"format:series"},
            {label:"Movie", value:"format:film"}
          ],
          bucketName: (b)=> b==="short"?"short":(b==="mid"?"mid":"long"),
          picksLabel: (bucket)=>`Picks (${bucket} slot):`
        },
        sleep: {
          intro: "Let‚Äôs help you fall asleep gently. How much time do you have?",
          chips: [
            {label:"5 minutes", value:"sleep:5"},
            {label:"10 minutes", value:"sleep:10"},
            {label:"Just tips", value:"sleep:tips"}
          ],
          tips: "Sleep tips:\n‚Ä¢ Eye mask/earplugs\n‚Ä¢ Support your lower back\n‚Ä¢ Bag under feet\n‚Ä¢ Small sips of water\n\nTell me aisle/window and I‚Äôll suggest a position.",
          five: "5 minutes:\n1) Inhale 4 seconds\n2) Exhale 6 seconds\nRepeat 8 cycles.\n\nContinue for 2 more minutes?",
          fiveChips: [
            {label:"Yes, +2", value:"sleep:more2"},
            {label:"No, enough", value:"sleep:done"}
          ],
          more2: "2 more minutes:\nInhale 4 ‚Äî exhale 8.\nIf you lose count ‚Äî calmly restart.\n\nDone.",
          done: "Okay. If thoughts keep coming ‚Äî count exhales from 1 to 20 and restart.",
          tenAsk: "10 minutes: ‚Äútiming only‚Äù or ‚Äúguided‚Äù?",
          tenChips: [
            {label:"Timing only", value:"sleep:timing"},
            {label:"Guided", value:"sleep:coach"}
          ],
          askStart: "Say ‚Äústart‚Äù and I‚Äôll guide you in short steps.",
          startNeed: "Type ‚Äústart‚Äù.",
          start1: "Start. 2 minutes: inhale 4 ‚Äî exhale 6.",
          start2: "Next. 3 minutes: relax forehead ‚Üí eyes ‚Üí jaw ‚Üí shoulders ‚Üí arms.",
          start3: "Final. 5 minutes: imagine a quiet corridor, each step ‚Äî an exhale.",
          startDone: "Done."
        },
        fly: {
          menu: "I can show the list of cities on the route or tell where we are right now.",
          chips: [
            {label:"Which cities do we overfly?", value:"fly:list"},
            {label:"Where are we now?", value:"fly:now"}
          ],
          routeTitle:"Route:",
          nowChips: [
            {label:"Where are we?", value:"fly:now"},
            {label:"Route cities", value:"fly:list"}
          ],
          listAfter: [
            {label:"Where are we now?", value:"fly:now"}
          ],
          weOver: (city)=>`We‚Äôre over ${city}.`
        },
        aircraft: {
          intro:"Quick fact: cruising altitude is usually around 10‚Äì12 km ‚Äî efficient for fuel and weather.",
          chips:[
            {label:"More facts", value:"air:more"},
            {label:"About speed", value:"air:speed"},
            {label:"About turbulence", value:"air:turb"}
          ],
          speed:"Typical cruise speed is about 800‚Äì900 km/h. Winds can noticeably change ground speed.",
          turb:"If it gets bumpy: keep your seatbelt fastened. Crew can change altitude/speed and avoid rough areas.",
          facts:[
            "Cabin pressure is maintained so breathing stays comfortable at altitude.",
            "Flaps and slats help fly slower during takeoff and landing.",
            "During landing the wing configuration changes ‚Äî that‚Äôs why you hear clicks and more airflow noise."
          ]
        },
        crew: {
          ask:"What should I pass to the cabin crew?",
          options:[
            {label:"Please bring water", value:"crew:water"},
            {label:"I need a pillow", value:"crew:pillow"},
            {label:"Order dinner", value:"crew:dinner"},
            {label:"Bring a kids menu", value:"crew:kids"}
          ],
          accepted:(phrase)=>`Received: ‚Äú${phrase}‚Äù. Anything else?`,
          after:[
            {label:"One more request", value:"crew:more"},
            {label:"Done", value:"crew:done"}
          ],
          ok:"Okay."
        },
        voice: {
          recording:"Recording. Tap ‚ÄúStop‚Äù to send a voice note.",
          gotVoice:"Voice note received. For an exact reply, type a short message or use ‚Äú+‚Äù scenarios.",
          noSupport:"Voice recording isn‚Äôt supported in this browser. You can keep using text.",
          micFail:"Couldn‚Äôt access the microphone. Check browser permissions."
        }
      },

      tr: {
        appTitle: "AeroArkada≈ü",
        emptyHint: "Senaryolar i√ßin ‚Äú+‚Äùa dokun ya da yaz ‚Äî u√ßu≈ü boyunca yardƒ±mcƒ± olurum.",
        placeholder: "Bana sor",
        drawerTitle: "Gezinme",
        nav: {
          aerofriend: { name: "AeroArkada≈ü", sub: "U√ßu≈ü i√ßi sohbet asistanƒ±" },
          entertainment: { name: "Eƒülence Merkezi", sub: "Film, m√ºzik, oyun" },
          map3d: { name: "3D Harita", sub: "Rotayƒ± 3D g√∂r" }
        },
        langTitle: "Dil",
        sheetTitle: "U√ßu≈üta ne yapalƒ±m",
        sheetSubtitle: "Bir senaryo se√ß ‚Äî birka√ß soru sorup se√ßenek √∂nereceƒüim.",
        actions: {
          watchName:"üé¨ ƒ∞zlenecek √∂neri",
          watchDesc:"U√ßu≈ü s√ºresi ve zevke g√∂re film/dizi.",
          sleepName:"üåô Nazik√ße uyku",
          sleepDesc:"Nefes ve gev≈üeme ile sakinle≈ü.",
          flyName:"üó∫Ô∏è Rota & konum",
          flyDesc:"Rota ≈üehirleri ve ≈üu an neredeyiz.",
          airName:"‚úàÔ∏è U√ßak bilgileri",
          airDesc:"ƒ∞rtifa, hƒ±z, t√ºrb√ºlans ‚Äî kƒ±sa a√ßƒ±klamalar."
        },
        quick: {
          crew: "Kabin ekibi ile ileti≈üim",
          voice: "üéôÔ∏è Konu≈ü",
          voiceStop: "‚èπÔ∏è Kaydƒ± durdur"
        },
        errors: {
          pickList: "√úzg√ºn√ºm, anlayamadƒ±m. L√ºtfen listeden se√ßin."
        },
        mainMenu: [
          {label:"üé¨ ƒ∞zleme √∂nerileri", value:"start:watch"},
          {label:"üåô Uyku desteƒüi", value:"start:sleep"},
          {label:"üó∫Ô∏è Rota & konum", value:"start:flyover"},
          {label:"‚úàÔ∏è U√ßak bilgileri", value:"start:aircraft"},
          {label:"Kabin ekibi", value:"start:crew"},
        ],
        smalltalk: {
          hello: "Merhaba. Ben AeroArkada≈ü. Senaryolar i√ßin ‚Äú+‚Äùa dokun ya da isteƒüini s√∂yle.",
          thanks: "Rica ederim. Bir senaryo se√ß veya soru sor."
        },
        watch: {
          askDuration: "ƒ∞zlenecek bir ≈üey √∂nerebilirim. U√ßu≈ü s√ºresi ne kadar? ‚Äú2:30‚Äù ya da ‚Äú150 dakika‚Äù yazabilirsin.",
          askGenre: "Tamam. Hangi t√ºr?",
          askFormat: "Format: dizi mi film mi?",
          refineChips: [
            {label:"Daha hafif", value:"watch:lighter"},
            {label:"Daha sert", value:"watch:harder"},
            {label:"T√ºr deƒüi≈ütir", value:"watch:genre"}
          ],
          durationChips: [
            {label:"1 saate kadar", value:"~1h"},
            {label:"1‚Äì2 saat", value:"~1-2h"},
            {label:"2‚Äì4 saat", value:"~2-4h"},
            {label:"4+ saat", value:"~4+h"}
          ],
          genreChips: [
            {label:"Komedi", value:"genre:comedy"},
            {label:"Gizem/gerilim", value:"genre:detective"},
            {label:"Dram", value:"genre:drama"},
            {label:"Bilim kurgu", value:"genre:scifi"}
          ],
          formatChips: [
            {label:"Dizi", value:"format:series"},
            {label:"Film", value:"format:film"}
          ],
          bucketName: (b)=> b==="short"?"kƒ±sa":(b==="mid"?"orta":"uzun"),
          picksLabel: (bucket)=>`√ñneriler (${bucket}):`
        },
        sleep: {
          intro: "Uyumana nazik√ße yardƒ±m edelim. Ne kadar vaktin var?",
          chips: [
            {label:"5 dakika", value:"sleep:5"},
            {label:"10 dakika", value:"sleep:10"},
            {label:"Sadece ipu√ßlarƒ±", value:"sleep:tips"}
          ],
          tips: "Uyku ipu√ßlarƒ±:\n‚Ä¢ G√∂z bandƒ±/kulak tƒ±kacƒ±\n‚Ä¢ Bel desteƒüi\n‚Ä¢ Ayak altƒ±na √ßanta\n‚Ä¢ Az yudum su\n\nKoltuk (koridor/pencere) s√∂yle, poz √∂neririm.",
          five: "5 dakika:\n1) 4 sn nefes al\n2) 6 sn nefes ver\n8 d√∂ng√º tekrar.\n\n2 dakika daha devam?",
          fiveChips: [
            {label:"Evet, +2", value:"sleep:more2"},
            {label:"Hayƒ±r, yeter", value:"sleep:done"}
          ],
          more2: "2 dakika daha:\n4 sn al ‚Äî 8 sn ver.\nSayƒ±m bozulursa sakin√ße ba≈üa d√∂n.\n\nBitti.",
          done: "Tamam. D√º≈ü√ºnceler gelirse, nefes veri≈ülerini 1‚Äôden 20‚Äôye say ve tekrar ba≈üla.",
          tenAsk: "10 dakika: ‚Äúsadece s√ºre‚Äù mi ‚Äúrehberli‚Äù mi?",
          tenChips: [
            {label:"Sadece s√ºre", value:"sleep:timing"},
            {label:"Rehberli", value:"sleep:coach"}
          ],
          askStart: "‚Äústart‚Äù yaz, kƒ±sa adƒ±mlarla y√∂nlendireyim.",
          startNeed: "‚Äústart‚Äù yaz.",
          start1: "Start. 2 dakika: 4 sn al ‚Äî 6 sn ver.",
          start2: "Sonra. 3 dakika: alƒ±n ‚Üí g√∂z ‚Üí √ßene ‚Üí omuz ‚Üí kollarƒ± gev≈üet.",
          start3: "Final. 5 dakika: sessiz bir koridor hayal et, her adƒ±m ‚Äî nefes veri≈ü.",
          startDone: "Bitti."
        },
        fly: {
          menu: "Rota ≈üehirlerini listeleyebilirim ya da ≈üu an nerede olduƒüumuzu s√∂yleyebilirim.",
          chips: [
            {label:"Hangi ≈üehirlerin √ºst√ºnden ge√ßiyoruz?", value:"fly:list"},
            {label:"≈ûu an neredeyiz?", value:"fly:now"}
          ],
          routeTitle:"Rota:",
          nowChips: [
            {label:"Neredeyiz?", value:"fly:now"},
            {label:"Rota ≈üehirleri", value:"fly:list"}
          ],
          listAfter: [
            {label:"≈ûu an neredeyiz?", value:"fly:now"}
          ],
          weOver: (city)=>`${city} √ºzerindeyiz.`
        },
        aircraft: {
          intro:"Kƒ±sa bilgi: seyir irtifasƒ± genelde 10‚Äì12 km civarƒ±dƒ±r ‚Äî yakƒ±t ve hava i√ßin verimlidir.",
          chips:[
            {label:"Daha fazla", value:"air:more"},
            {label:"Hƒ±z", value:"air:speed"},
            {label:"T√ºrb√ºlans", value:"air:turb"}
          ],
          speed:"Tipik seyir hƒ±zƒ± 800‚Äì900 km/s. R√ºzg√¢r, yere g√∂re hƒ±zƒ± ciddi etkileyebilir.",
          turb:"Sarsƒ±ntƒ±da kemer baƒülƒ± olsun. Ekip irtifa/hƒ±z deƒüi≈ütirerek p√ºr√ºzl√º b√∂lgeleri a≈üabilir.",
          facts:[
            "Kabin basƒ±ncƒ±, y√ºksekte rahat nefes almak i√ßin ayarlanƒ±r.",
            "Flap/slat, kalkƒ±≈ü ve ini≈üte daha yava≈ü u√ßmayƒ± saƒülar.",
            "ƒ∞ni≈üte kanat konfig√ºrasyonu deƒüi≈üir ‚Äî bu y√ºzden tƒ±kƒ±rtƒ±lar ve hava sesi artar."
          ]
        },
        crew: {
          ask:"Kabin ekibine ne ileteyim?",
          options:[
            {label:"Su getirir misiniz", value:"crew:water"},
            {label:"Yastƒ±k istiyorum", value:"crew:pillow"},
            {label:"Ak≈üam yemeƒüi sipari≈üi", value:"crew:dinner"},
            {label:"√áocuk men√ºs√º", value:"crew:kids"}
          ],
          accepted:(phrase)=>`Alƒ±ndƒ±: ‚Äú${phrase}‚Äù. Ba≈üka bir isteƒüin var mƒ±?`,
          after:[
            {label:"Bir istek daha", value:"crew:more"},
            {label:"Bitti", value:"crew:done"}
          ],
          ok:"Tamam."
        },
        voice: {
          recording:"Kayƒ±t alƒ±yorum. Sesli mesaj g√∂ndermek i√ßin ‚ÄúDurdur‚Äùa bas.",
          gotVoice:"Sesli mesaj alƒ±ndƒ±. Kesin yanƒ±t i√ßin kƒ±saca yazabilir veya ‚Äú+‚Äù senaryolarƒ±nƒ± kullanabilirsin.",
          noSupport:"Bu tarayƒ±cƒ±da ses kaydƒ± desteklenmiyor. Metinle devam edebilirsin.",
          micFail:"Mikrofona eri≈üilemedi. Tarayƒ±cƒ± izinlerini kontrol et."
        }
      }
    };

    let LANG = "ru";
    const t = () => I18N[LANG];

    // =========================
    // Route: Moscow -> Kazan (realistic corridor)
    // Moscow ‚Üí Vladimir ‚Üí Nizhny Novgorod ‚Üí Cheboksary ‚Üí Kazan
    // + correct RU declensions for ‚Äúwe are over‚Äù
    // =========================
    const ROUTE = [
      { key:"moscow", name:{ru:"–ú–æ—Å–∫–≤–∞", en:"Moscow", tr:"Moskova"},
        over:{ru:"–ú–æ—Å–∫–≤–æ–π", en:"Moscow", tr:"Moskova"},
        info:{
          ru:"–ú–æ—Å–∫–≤–∞ ‚Äî –∫—Ä—É–ø–Ω–µ–π—à–∏–π –≥–æ—Ä–æ–¥ –†–æ—Å—Å–∏–∏, –∫—É–ª—å—Ç—É—Ä–Ω—ã–π –∏ –¥–µ–ª–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä. –ö—Ä–µ–º–ª—å –∏ –ö—Ä–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥—å ‚Äî –≥–ª–∞–≤–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã.",
          en:"Moscow is Russia‚Äôs largest city and a major cultural and business hub. The Kremlin and Red Square are iconic landmarks.",
          tr:"Moskova, Rusya‚Äônƒ±n en b√ºy√ºk ≈üehri ve √∂nemli bir k√ºlt√ºr/i≈ü merkezidir. Kremlin ve Kƒ±zƒ±l Meydan en bilinen yerlerdir."
        }
      },
      { key:"vladimir", name:{ru:"–í–ª–∞–¥–∏–º–∏—Ä", en:"Vladimir", tr:"Vladimir"},
        over:{ru:"–í–ª–∞–¥–∏–º–∏—Ä–æ–º", en:"Vladimir", tr:"Vladimir"},
        info:{
          ru:"–í–ª–∞–¥–∏–º–∏—Ä ‚Äî –¥—Ä–µ–≤–Ω–∏–π –≥–æ—Ä–æ–¥ –ó–æ–ª–æ—Ç–æ–≥–æ –∫–æ–ª—å—Ü–∞. –ó–Ω–∞–º–µ–Ω–∏—Ç –±–µ–ª–æ–∫–∞–º–µ–Ω–Ω—ã–º–∏ —Å–æ–±–æ—Ä–∞–º–∏ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º —Ü–µ–Ω—Ç—Ä–æ–º.",
          en:"Vladimir is an ancient Golden Ring city known for white-stone cathedrals and its historic core.",
          tr:"Vladimir, Altƒ±n Halka‚Äônƒ±n eski ≈üehirlerinden biridir. Beyaz ta≈ü katedralleriyle √ºnl√ºd√ºr."
        }
      },
      { key:"nizhny", name:{ru:"–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥", en:"Nizhny Novgorod", tr:"Nijniy Novgorod"},
        over:{ru:"–ù–∏–∂–Ω–∏–º –ù–æ–≤–≥–æ—Ä–æ–¥–æ–º", en:"Nizhny Novgorod", tr:"Nijniy Novgorod"},
        info:{
          ru:"–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥ ‚Äî –∫—Ä—É–ø–Ω—ã–π –≥–æ—Ä–æ–¥ –Ω–∞ —Å–ª–∏—è–Ω–∏–∏ –í–æ–ª–≥–∏ –∏ –û–∫–∏. –ò–∑–≤–µ—Å—Ç–µ–Ω –∫—Ä–µ–º–ª—ë–º –∏ –Ω–∞–±–µ—Ä–µ–∂–Ω—ã–º–∏.",
          en:"Nizhny Novgorod sits at the confluence of the Volga and Oka rivers, known for its kremlin and river embankments.",
          tr:"Nijniy Novgorod, Volga ve Oka‚Äônƒ±n birle≈ütiƒüi yerde bulunur; kalesi ve nehir kƒ±yƒ±larƒ±yla bilinir."
        }
      },
      { key:"cheboksary", name:{ru:"–ß–µ–±–æ–∫—Å–∞—Ä—ã", en:"Cheboksary", tr:"√áeboksarƒ±"},
        over:{ru:"–ß–µ–±–æ–∫—Å–∞—Ä–∞–º–∏", en:"Cheboksary", tr:"√áeboksarƒ±"},
        info:{
          ru:"–ß–µ–±–æ–∫—Å–∞—Ä—ã ‚Äî —Å—Ç–æ–ª–∏—Ü–∞ –ß—É–≤–∞—à–∏–∏ –Ω–∞ –í–æ–ª–≥–µ. –ó–¥–µ—Å—å –∫—Ä–∞—Å–∏–≤—ã–π –∑–∞–ª–∏–≤ –∏ –ø—Ä–æ–≥—É–ª–æ—á–Ω—ã–µ –Ω–∞–±–µ—Ä–µ–∂–Ω—ã–µ.",
          en:"Cheboksary is the capital of Chuvashia on the Volga River, known for its bay and waterfront promenades.",
          tr:"√áeboksarƒ±, Volga √ºzerindeki √áuva≈üistan‚Äôƒ±n ba≈ükentidir; koyu ve sahil y√ºr√ºy√º≈ü yollarƒ±yla bilinir."
        }
      },
      { key:"kazan", name:{ru:"–ö–∞–∑–∞–Ω—å", en:"Kazan", tr:"Kazan"},
        over:{ru:"–ö–∞–∑–∞–Ω—å—é", en:"Kazan", tr:"Kazan"},
        info:{
          ru:"–ö–∞–∑–∞–Ω—å ‚Äî —Å—Ç–æ–ª–∏—Ü–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω–∞ –Ω–∞ –í–æ–ª–≥–µ. –ö–∞–∑–∞–Ω—Å–∫–∏–π –ö—Ä–µ–º–ª—å –∏ –º–µ—á–µ—Ç—å –ö—É–ª-–®–∞—Ä–∏—Ñ ‚Äî —Å–∏–º–≤–æ–ª—ã –≥–æ—Ä–æ–¥–∞.",
          en:"Kazan is the capital of Tatarstan on the Volga. The Kazan Kremlin and Kul Sharif Mosque are iconic.",
          tr:"Kazan, Volga √ºzerindeki Tataristan‚Äôƒ±n ba≈ükentidir. Kazan Kremlini ve Kul ≈ûerif Camii sembol yerlerdir."
        }
      }
    ];

    // =========================
    // DOM
    // =========================
    const messagesEl = document.getElementById('messages');
    const emptyHintEl = document.getElementById('emptyHint');
    const inputEl = document.getElementById('input');
    const sendEl = document.getElementById('send');

    const burgerEl = document.getElementById('burger');
    const drawerOverlayEl = document.getElementById('drawerOverlay');
    const drawerCloseEl = document.getElementById('drawerClose');

    const plusEl = document.getElementById('plus');
    const overlayEl = document.getElementById('overlay');
    const closeSheetEl = document.getElementById('closeSheet');

    const crewBtnFixedEl = document.getElementById('crewBtnFixed');
    const voiceBtnEl = document.getElementById('voiceBtn');

    // labels
    const titleH1 = document.getElementById('titleH1');
    const sheetTitle = document.getElementById('sheetTitle');
    const sheetSubtitle = document.getElementById('sheetSubtitle');

    const actWatchName = document.getElementById('actWatchName');
    const actWatchDesc = document.getElementById('actWatchDesc');
    const actSleepName = document.getElementById('actSleepName');
    const actSleepDesc = document.getElementById('actSleepDesc');
    const actFlyName = document.getElementById('actFlyName');
    const actFlyDesc = document.getElementById('actFlyDesc');
    const actAirName = document.getElementById('actAirName');
    const actAirDesc = document.getElementById('actAirDesc');

    const drawerTitle = document.getElementById('drawerTitle');
    const navAerofriend = document.getElementById('navAerofriend');
    const navAerofriendSub = document.getElementById('navAerofriendSub');
    const navEntertainment = document.getElementById('navEntertainment');
    const navEntertainmentSub = document.getElementById('navEntertainmentSub');
    const navMap3d = document.getElementById('navMap3d');
    const navMap3dSub = document.getElementById('navMap3dSub');
    const langTitle = document.getElementById('langTitle');

    // =========================
    // Chat rendering
    // =========================
    function hideEmptyHint(){ if (emptyHintEl) emptyHintEl.style.display = 'none'; }

    function addMessage({from, text, chips}){
      hideEmptyHint();

      const msg = document.createElement('div');
      msg.className = `msg ${from}`;

      const label = document.createElement('div');
      label.className = 'label';
      label.textContent = (from === 'bot') ? (LANG === 'ru' ? '–ê–≠–†–û–î–†–£–ì' : (LANG === 'tr' ? 'AERO' : 'AEROF')) : (LANG === 'ru' ? '–í—ã' : (LANG === 'tr' ? 'Siz' : 'You'));

      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.textContent = text;

      msg.appendChild(label);
      msg.appendChild(bubble);

      if (Array.isArray(chips) && chips.length){
        const chipsWrap = document.createElement('div');
        chipsWrap.className = 'chips';

        for (const c of chips){
          const b = document.createElement('button');
          b.className = 'chip';
          b.type = 'button';
          b.textContent = c.label;

          // show label in chat, use value internally
          b.addEventListener('click', () => handleUserInput(c.label, c.value));

          chipsWrap.appendChild(b);
        }
        msg.appendChild(chipsWrap);
      }

      messagesEl.appendChild(msg);
      requestAnimationFrame(() => { messagesEl.scrollTop = messagesEl.scrollHeight; });
    }

    function addAudioMessage(audioUrl){
      hideEmptyHint();

      const msg = document.createElement('div');
      msg.className = 'msg user';

      const label = document.createElement('div');
      label.className = 'label';
      label.textContent = (LANG === 'ru' ? '–í—ã' : (LANG === 'tr' ? 'Siz' : 'You'));

      const bubble = document.createElement('div');
      bubble.className = 'bubble';

      const audio = document.createElement('audio');
      audio.controls = true;
      audio.src = audioUrl;
      audio.style.width = '260px';
      audio.style.maxWidth = '100%';

      bubble.appendChild(audio);
      msg.appendChild(label);
      msg.appendChild(bubble);
      messagesEl.appendChild(msg);

      requestAnimationFrame(() => { messagesEl.scrollTop = messagesEl.scrollHeight; });
    }

    function aeroSay(text, chips){ addMessage({from:'bot', text, chips}); }
    function userSay(text){ addMessage({from:'user', text}); }

    function errorPickFromList(chips){
      aeroSay(t().errors.pickList, chips || t().mainMenu);
    }

    // =========================
    // Drawer
    // =========================
    function openDrawer(){
      drawerOverlayEl.classList.add('open');
      drawerOverlayEl.setAttribute('aria-hidden', 'false');
    }
    function closeDrawer(){
      drawerOverlayEl.classList.remove('open');
      drawerOverlayEl.setAttribute('aria-hidden', 'true');
    }

    burgerEl.addEventListener('click', openDrawer);
    drawerCloseEl.addEventListener('click', closeDrawer);
    drawerOverlayEl.addEventListener('click', (e)=>{ if (e.target === drawerOverlayEl) closeDrawer(); });

    // Nav items (stub behavior)
    document.querySelectorAll('.navItem').forEach(item=>{
      item.addEventListener('click', ()=>{
        document.querySelectorAll('.navItem').forEach(x=>x.classList.remove('active'));
        item.classList.add('active');

        const page = item.getAttribute('data-page');
        if (page !== 'aerofriend'){
          // lightweight stub messages (still in chosen language)
          if (page === 'entertainment'){
            aeroSay(LANG==='ru' ? '–û—Ç–∫—Ä—ã–≤–∞—é ‚Äú–¶–µ–Ω—Ç—Ä —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π‚Äù. (–∑–∞–≥–ª—É—à–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)' :
                  LANG==='tr' ? '‚ÄúEƒülence Merkezi‚Äù a√ßƒ±lƒ±yor. (aray√ºz taslaƒüƒ±)' :
                  'Opening ‚ÄúEntertainment Center‚Äù. (UI stub)');
          } else if (page === 'map3d'){
            aeroSay(LANG==='ru' ? '–û—Ç–∫—Ä—ã–≤–∞—é ‚Äú3D-–∫–∞—Ä—Ç—É‚Äù. (–∑–∞–≥–ª—É—à–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)' :
                  LANG==='tr' ? '‚Äú3D Harita‚Äù a√ßƒ±lƒ±yor. (aray√ºz taslaƒüƒ±)' :
                  'Opening ‚Äú3D Map‚Äù. (UI stub)');
          }
          closeDrawer();
          return;
        }

        closeDrawer();
      });
    });

    // Language switching
    function setLang(newLang){
      LANG = newLang;
      document.documentElement.lang = newLang === 'ru' ? 'ru' : (newLang === 'tr' ? 'tr' : 'en');
      applyStaticTexts();
      // Not rewriting history; only future responses. Give a small system hint:
      aeroSay(
        newLang === 'ru' ? '–Ø–∑—ã–∫ –ø–µ—Ä–µ–∫–ª—é—á—ë–Ω –Ω–∞ —Ä—É—Å—Å–∫–∏–π.' :
        newLang === 'tr' ? 'Dil T√ºrk√ße olarak deƒüi≈ütirildi.' :
        'Language switched to English.'
      );
    }

    document.querySelectorAll('.langBtn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.langBtn').forEach(x=>x.classList.remove('active'));
        btn.classList.add('active');
        setLang(btn.getAttribute('data-lang'));
      });
    });

    // =========================
    // Scenario popup
    // =========================
    function openSheet(){
      overlayEl.classList.add('open');
      overlayEl.setAttribute('aria-hidden','false');
    }
    function closeSheet(){
      overlayEl.classList.remove('open');
      overlayEl.setAttribute('aria-hidden','true');
    }
    plusEl.addEventListener('click', ()=> overlayEl.classList.contains('open') ? closeSheet() : openSheet());
    closeSheetEl.addEventListener('click', closeSheet);
    overlayEl.addEventListener('click', (e)=>{ if (e.target === overlayEl) closeSheet(); });
    overlayEl.querySelectorAll('[data-action]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        closeSheet();
        startFlow(btn.getAttribute('data-action'));
      });
    });

    // =========================
    // State machine
    // =========================
    const state = {
      flow: null,      // null | watch | sleep | flyover | aircraft | crew
      step: null,
      data: {
        routeIdx: 0,
        watch: {}
      }
    };

    function resetFlow(){
      state.flow = null;
      state.step = null;
    }

    // =========================
    // Watch content (same lists, language-neutral titles)
    // =========================
    const watchLibrary = {
      short: {
        comedy: { film: ['The Grand Budapest Hotel','Palm Springs','Paddington'], series:['The Office ‚Äî 2‚Äì3 eps','Modern Family ‚Äî 3‚Äì4 eps','Brooklyn Nine-Nine ‚Äî 3‚Äì4 eps'] },
        detective: { film:['Knives Out','Sherlock Holmes (2009)','Gone Girl'], series:['Sherlock ‚Äî 1 ep','Only Murders ‚Äî 2‚Äì3 eps','Broadchurch ‚Äî 2 eps'] },
        drama: { film:['Whiplash','The Truman Show','Little Miss Sunshine'], series:['The Bear ‚Äî 2‚Äì3 eps','Fleabag ‚Äî 3‚Äì4 eps','The Queen‚Äôs Gambit ‚Äî 1 ep'] },
        scifi: { film:['Source Code','Edge of Tomorrow','Her'], series:['Black Mirror ‚Äî 1 ep','Love, Death & Robots','Stranger Things ‚Äî 1‚Äì2 eps'] }
      },
      mid: {
        comedy: { film:['The Intern','Free Guy','Chef'], series:['Ted Lasso ‚Äî 2‚Äì4 eps','Friends ‚Äî 4‚Äì6 eps','HIMYM ‚Äî 4‚Äì6 eps'] },
        detective: { film:['Prisoners','Zodiac','Gone Girl'], series:['Mindhunter ‚Äî 2‚Äì3 eps','Mare of Easttown ‚Äî 2 eps','Broadchurch ‚Äî 3 eps'] },
        drama: { film:['The Social Network','Arrival','La La Land'], series:['The Queen‚Äôs Gambit ‚Äî 2 eps','Severance ‚Äî 2 eps','The Crown ‚Äî 2 eps'] },
        scifi: { film:['Ex Machina','The Martian','Arrival'], series:['The Expanse ‚Äî 2‚Äì3 eps','Dark ‚Äî 1‚Äì2 eps','Westworld ‚Äî 1‚Äì2 eps'] }
      },
      long: {
        comedy: { film:['Forrest Gump','The Wolf of Wall Street','The Big Lebowski'], series:['The Office ‚Äî 6‚Äì8 eps','Modern Family ‚Äî 6‚Äì8 eps','Ted Lasso ‚Äî 5‚Äì6 eps'] },
        detective: { film:['The Godfather','The Irishman','Se7en'], series:['True Detective ‚Äî 4‚Äì5 eps','Broadchurch ‚Äî 5‚Äì6 eps','Mindhunter ‚Äî 4‚Äì5 eps'] },
        drama: { film:['Oppenheimer','Dune (2021)','Interstellar'], series:['The Crown ‚Äî 4‚Äì5 eps','Severance ‚Äî 4‚Äì5 eps','The Queen‚Äôs Gambit ‚Äî 3‚Äì4 eps'] },
        scifi: { film:['Interstellar','Dune (2021)','Blade Runner 2049'], series:['The Expanse ‚Äî 5‚Äì6 eps','Dark ‚Äî 4 eps','Westworld ‚Äî 4‚Äì5 eps'] }
      }
    };

    function parseDuration(text){
      const raw = (text||'').trim();
      const tNorm = raw.toLowerCase().replace(/—ë/g,'–µ');
      if (tNorm.startsWith('~')) return tNorm;

      const hm = tNorm.match(/^(\d{1,2})\s*:\s*(\d{1,2})$/);
      if (hm){
        const h = parseInt(hm[1],10), m = parseInt(hm[2],10);
        if (!isNaN(h) && !isNaN(m)) return h*60+m;
      }
      const min = tNorm.match(/(\d{1,4})\s*(min|minutes|–º–∏–Ω|–º)\b/);
      if (min){ const m = parseInt(min[1],10); if (!isNaN(m)) return m; }
      const hr = tNorm.match(/(\d{1,2})\s*(h|hour|hours|—á|—á–∞—Å)\b/);
      if (hr){ const h = parseInt(hr[1],10); if (!isNaN(h)) return h*60; }
      return null;
    }

    function durationToBucket(d){
      if (typeof d === 'string'){
        if (d.includes('~1h')) return 'short';
        if (d.includes('~1-2h')) return 'short';
        if (d.includes('~2-4h')) return 'mid';
        if (d.includes('~4+h')) return 'long';
        return 'mid';
      }
      if (typeof d === 'number'){
        if (d <= 90) return 'short';
        if (d <= 160) return 'mid';
        return 'long';
      }
      return 'mid';
    }

    function buildWatchResult(bucket, genreKey, formatKey){
      const list = watchLibrary[bucket]?.[genreKey]?.[formatKey] || [];
      const bucketLabel = t().watch.bucketName(bucket);
      const header = t().watch.picksLabel(bucketLabel);
      return `${header}\n‚Ä¢ ${list.join('\n‚Ä¢ ')}`;
    }

    // =========================
    // Route helpers
    // =========================
    function routeListText(){
      const title = t().fly.routeTitle;
      const lines = ROUTE.map(r => "‚Ä¢ " + r.name[LANG]);
      return `${title}\n${lines.join("\n")}`;
    }

    function currentRoutePoint(){
      const idx = Math.min(state.data.routeIdx || 0, ROUTE.length - 1);
      return ROUTE[idx];
    }

    function advanceRoute(){
      if (state.data.routeIdx == null) state.data.routeIdx = 0;
      if (state.data.routeIdx < ROUTE.length - 1) state.data.routeIdx += 1;
    }

    function flyNowAnswer(){
      const p = currentRoutePoint();
      const line1 = t().fly.weOver(p.over[LANG]);
      const line2 = p.info[LANG];
      advanceRoute();
      return `${line1}\n${line2}`;
    }

    // =========================
    // Crew phrases
    // =========================
    function crewPhraseByValue(v){
      // use current language labels so the echo looks native
      const opt = t().crew.options.find(x => x.value === v);
      return opt ? opt.label : null;
    }

    // =========================
    // Start flows
    // =========================
    function startFlow(flow){
      state.flow = flow;
      state.step = null;

      if (flow === 'watch'){
        state.step = 'askDuration';
        aeroSay(t().watch.askDuration, t().watch.durationChips);
        return;
      }
      if (flow === 'sleep'){
        state.step = 'sleepIntro';
        aeroSay(t().sleep.intro, t().sleep.chips);
        return;
      }
      if (flow === 'flyover'){
        state.step = 'flyMenu';
        aeroSay(t().fly.menu, t().fly.chips);
        return;
      }
      if (flow === 'aircraft'){
        state.step = 'airMenu';
        aeroSay(t().aircraft.intro, t().aircraft.chips);
        return;
      }
      if (flow === 'crew'){
        state.step = 'crewPick';
        aeroSay(t().crew.ask, t().crew.options);
        return;
      }

      resetFlow();
      errorPickFromList();
    }

    // =========================
    // Internal handler (chip values)
    // =========================
    function handleInternal(value){
      if (!value) return false;

      // Global starts
      if (value.startsWith('start:')){
        startFlow(value.split(':')[1]);
        return true;
      }

      // Crew: ALWAYS handle done/more (fix)
      if (value === 'crew:done'){
        aeroSay(t().crew.ok);
        resetFlow();
        return true;
      }
      if (value === 'crew:more'){
        state.flow = 'crew';
        state.step = 'crewPick';
        aeroSay(t().crew.ask, t().crew.options);
        return true;
      }
      if (value.startsWith('crew:')){
        state.flow = 'crew';
        state.step = 'crewDone';
        const phrase = crewPhraseByValue(value);
        if (!phrase){
          errorPickFromList(t().crew.options);
          return true;
        }
        aeroSay(t().crew.accepted(phrase), t().crew.after);
        return true;
      }

      // Flyover
      if (value === 'fly:list'){
        state.flow = 'flyover';
        state.step = 'flyMenu';
        aeroSay(routeListText(), t().fly.listAfter);
        return true;
      }
      if (value === 'fly:now'){
        state.flow = 'flyover';
        state.step = 'flyMenu';
        aeroSay(flyNowAnswer(), t().fly.nowChips);
        return true;
      }

      // Aircraft
      if (value === 'air:speed'){
        state.flow = 'aircraft';
        aeroSay(t().aircraft.speed, t().aircraft.chips);
        return true;
      }
      if (value === 'air:turb'){
        state.flow = 'aircraft';
        aeroSay(t().aircraft.turb, t().aircraft.chips);
        return true;
      }
      if (value === 'air:more'){
        state.flow = 'aircraft';
        const facts = t().aircraft.facts;
        aeroSay(facts[Math.floor(Math.random()*facts.length)], t().aircraft.chips);
        return true;
      }

      // Watch
      if (value === '~1h' || value === '~1-2h' || value === '~2-4h' || value === '~4+h'){
        if (state.flow !== 'watch' || state.step !== 'askDuration') return false;
        state.data.watch.duration = value;
        state.data.watch.bucket = durationToBucket(value);
        state.step = 'askGenre';
        aeroSay(t().watch.askGenre, t().watch.genreChips);
        return true;
      }
      if (value.startsWith('genre:')){
        if (state.flow !== 'watch') return false;
        state.data.watch.genre = value.split(':')[1];
        state.step = 'askFormat';
        aeroSay(t().watch.askFormat, t().watch.formatChips);
        return true;
      }
      if (value.startsWith('format:')){
        if (state.flow !== 'watch') return false;
        state.data.watch.format = value.split(':')[1];
        state.step = 'refine';
        aeroSay(buildWatchResult(
          state.data.watch.bucket || 'mid',
          state.data.watch.genre || 'comedy',
          state.data.watch.format || 'film'
        ), t().watch.refineChips);
        return true;
      }
      if (value === 'watch:genre'){
        if (state.flow !== 'watch') return false;
        state.step = 'askGenre';
        aeroSay(t().watch.askGenre, t().watch.genreChips);
        return true;
      }
      if (value === 'watch:lighter'){
        if (state.flow !== 'watch') return false;
        state.data.watch.genre = 'comedy';
        state.step = 'refine';
        aeroSay(buildWatchResult(
          state.data.watch.bucket || 'mid',
          'comedy',
          state.data.watch.format || 'film'
        ), t().watch.refineChips);
        return true;
      }
      if (value === 'watch:harder'){
        if (state.flow !== 'watch') return false;
        state.data.watch.genre = 'detective';
        state.step = 'refine';
        aeroSay(buildWatchResult(
          state.data.watch.bucket || 'mid',
          'detective',
          state.data.watch.format || 'film'
        ), t().watch.refineChips);
        return true;
      }

      // Sleep
      if (value === 'sleep:tips'){
        if (state.flow !== 'sleep') return false;
        aeroSay(t().sleep.tips);
        resetFlow();
        return true;
      }
      if (value === 'sleep:5'){
        if (state.flow !== 'sleep') return false;
        state.step = 'sleep5';
        aeroSay(t().sleep.five, t().sleep.fiveChips);
        return true;
      }
      if (value === 'sleep:more2'){
        if (state.flow !== 'sleep') return false;
        aeroSay(t().sleep.more2);
        resetFlow();
        return true;
      }
      if (value === 'sleep:done'){
        if (state.flow !== 'sleep') return false;
        aeroSay(t().sleep.done);
        resetFlow();
        return true;
      }
      if (value === 'sleep:10'){
        if (state.flow !== 'sleep') return false;
        state.step = 'sleep10';
        aeroSay(t().sleep.tenAsk, t().sleep.tenChips);
        return true;
      }
      if (value === 'sleep:timing' || value === 'sleep:coach'){
        if (state.flow !== 'sleep') return false;
        state.step = 'sleep10Start';
        aeroSay(t().sleep.askStart);
        return true;
      }

      return false;
    }

    // =========================
    // Text intent detection (minimal + multilingual)
    // =========================
    function normalize(s){ return (s||'').toLowerCase().replace(/—ë/g,'–µ').trim(); }

    function detectIntent(text){
      const n = normalize(text);

      // Smalltalk
      if (n.includes('–ø—Ä–∏–≤–µ—Ç') || n.includes('–∑–¥—Ä–∞–≤') || n === 'hi' || n.includes('hello') || n.includes('merhaba') || n.includes('selam')){
        return {type:'smalltalk', kind:'hello'};
      }
      if (n.includes('—Å–ø–∞—Å–∏–±–æ') || n.includes('thanks') || n.includes('te≈üekk√ºr') || n.includes('tesekkur')){
        return {type:'smalltalk', kind:'thanks'};
      }

      // Crew (done)
      if (n === '–≥–æ—Ç–æ–≤–æ' || n.includes('–≥–æ—Ç–æ–≤')) return {type:'internal', value:'crew:done'};
      if (n.includes('done') || n.includes('finish')) return {type:'internal', value:'crew:done'};
      if (n.includes('bitti') || n.includes('tamam')) return {type:'internal', value:'crew:done'};

      // Crew keywords
      if (n.includes('–±–æ—Ä—Ç–ø—Ä–æ–≤–æ–¥') || n.includes('–ø—Ä–æ–≤–æ–¥–Ω–∏–∫') || n.includes('crew') || n.includes('cabin') || n.includes('kabin')){
        return {type:'start', flow:'crew'};
      }
      if (n.includes('–≤–æ–¥—É') || n.includes('water') || n.includes('su')) return {type:'internal', value:'crew:water'};
      if (n.includes('–ø–æ–¥—É—à') || n.includes('pillow') || n.includes('yast')) return {type:'internal', value:'crew:pillow'};
      if (n.includes('—É–∂–∏–Ω') || n.includes('dinner') || n.includes('ak≈üam')) return {type:'internal', value:'crew:dinner'};
      if ((n.includes('–¥–µ—Ç—Å–∫') && n.includes('–º–µ–Ω—é')) || n.includes('kids menu') || n.includes('√ßocuk men√º') || n.includes('cocuk menu')){
        return {type:'internal', value:'crew:kids'};
      }

      // Flyover
      if (n.includes('–≥–¥–µ –º—ã') || n.includes('–∞ –≥–¥–µ –º—ã') || n.includes('where are we') || n.includes('where now') || n.includes('≈üu an') || n.includes('neredeyiz')){
        return {type:'internal', value:'fly:now'};
      }
      if (n.includes('–º–∞—Ä—à—Ä—É—Ç') || n.includes('–∫–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞') || n.includes('route') || n.includes('cities') || n.includes('rota') || n.includes('≈üehir')){
        return {type:'internal', value:'fly:list'};
      }
      if (n.includes('–ø—Ä–æ–ª–µ—Ç–∞–µ–º') || n.includes('overfly') || n.includes('ge√ßiyoruz')) return {type:'start', flow:'flyover'};

      // Watch
      if (n.includes('—á—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å') || n.includes('–ø–æ—Å–æ–≤–µ—Ç—É–π') || n.includes('movie') || n.includes('series') || n.includes('watch') || n.includes('izle') || n.includes('film') || n.includes('dizi')){
        return {type:'start', flow:'watch'};
      }

      // Sleep
      if (n.includes('—É—Å–Ω—É—Ç—å') || n.includes('—Å–æ–Ω') || n.includes('sleep') || n.includes('uyku') || n.includes('uyum')){
        return {type:'start', flow:'sleep'};
      }

      // Aircraft
      if (n.includes('—Å–∞–º–æ–ª–µ—Ç') || n.includes('—Å–∞–º–æ–ª—ë—Ç') || n.includes('turb') || n.includes('turbu') || n.includes('speed') || n.includes('hƒ±z') || n.includes('irtifa') || n.includes('altitude') || n.includes('aircraft') || n.includes('u√ßak') || n.includes('ucak')){
        return {type:'start', flow:'aircraft'};
      }

      // Sleep start (typed)
      if (n === '—Å—Ç–∞—Ä—Ç' || n === 'start') return {type:'sleepStart'};

      return null;
    }

    // =========================
    // Flow text handlers
    // =========================
    function handleWatchText(text){
      if (state.step === 'askDuration'){
        const d = parseDuration(text);
        if (d == null){
          errorPickFromList(t().watch.durationChips);
          return;
        }
        state.data.watch.duration = d;
        state.data.watch.bucket = durationToBucket(d);
        state.step = 'askGenre';
        aeroSay(t().watch.askGenre, t().watch.genreChips);
        return;
      }

      // For text-only genre/format, keep it strict (chips preferred)
      errorPickFromList(t().watch.genreChips);
    }

    function handleSleepText(text){
      const n = normalize(text);

      if (state.step === 'sleepIntro'){
        // accept digits
        if (n.includes('5')) return handleInternal('sleep:5');
        if (n.includes('10')) return handleInternal('sleep:10');
        errorPickFromList(t().sleep.chips);
        return;
      }

      if (state.step === 'sleep10Start'){
        if (n === '—Å—Ç–∞—Ä—Ç' || n === 'start'){
          aeroSay(t().sleep.start1);
          setTimeout(()=>aeroSay(t().sleep.start2), 2200);
          setTimeout(()=>aeroSay(t().sleep.start3), 4400);
          setTimeout(()=>{ aeroSay(t().sleep.startDone); resetFlow(); }, 6600);
          return;
        }
        aeroSay(t().sleep.startNeed);
        return;
      }

      errorPickFromList(t().sleep.chips);
    }

    function handleFlyText(){
      errorPickFromList(t().fly.chips);
    }

    function handleAircraftText(text){
      const n = normalize(text);
      if (n.includes('speed') || n.includes('—Å–∫–æ—Ä–æ—Å—Ç') || n.includes('hƒ±z') || n.includes('hiz')) return handleInternal('air:speed');
      if (n.includes('turb') || n.includes('—Ç—É—Ä–±—É–ª') || n.includes('turbu')) return handleInternal('air:turb');
      if (n.includes('–µ—â—ë') || n.includes('more') || n.includes('daha')) return handleInternal('air:more');
      errorPickFromList(t().aircraft.chips);
    }

    function handleCrewText(text){
      // Always allow done via text, regardless of state
      const n = normalize(text);
      if (n === '–≥–æ—Ç–æ–≤–æ' || n.includes('–≥–æ—Ç–æ–≤') || n.includes('done') || n.includes('finish') || n.includes('bitti') || n.includes('tamam')){
        handleInternal('crew:done');
        return;
      }
      if (n.includes('–µ—â') || n.includes('more') || n.includes('daha')){
        handleInternal('crew:more');
        return;
      }
      if (n.includes('–≤–æ–¥—É') || n.includes('water') || n.includes('su')) return handleInternal('crew:water');
      if (n.includes('–ø–æ–¥—É—à') || n.includes('pillow') || n.includes('yast')) return handleInternal('crew:pillow');
      if (n.includes('—É–∂–∏–Ω') || n.includes('dinner') || n.includes('ak≈üam')) return handleInternal('crew:dinner');
      if ((n.includes('–¥–µ—Ç—Å–∫') && n.includes('–º–µ–Ω—é')) || n.includes('kids menu') || n.includes('√ßocuk') || n.includes('cocuk')) return handleInternal('crew:kids');

      // If in crew flow and in done step, show done/more
      if (state.step === 'crewDone') return errorPickFromList(t().crew.after);
      errorPickFromList(t().crew.options);
    }

    // =========================
    // Main input handler
    // =========================
    function handleUserInput(displayText, internalValue=null){
      const text = (displayText || '').trim();
      if (!text) return;

      userSay(text);

      // chips
      if (internalValue){
        if (!handleInternal(internalValue)) errorPickFromList();
        return;
      }

      const intent = detectIntent(text);

      // no active flow
      if (!state.flow){
        if (!intent){
          errorPickFromList(t().mainMenu);
          return;
        }

        if (intent.type === 'smalltalk'){
          aeroSay(intent.kind === 'hello' ? t().smalltalk.hello : t().smalltalk.thanks, t().mainMenu);
          return;
        }

        if (intent.type === 'start'){
          startFlow(intent.flow);
          return;
        }

        if (intent.type === 'internal'){
          if (!handleInternal(intent.value)) errorPickFromList();
          return;
        }

        if (intent.type === 'sleepStart'){
          // if user says start without flow, just show sleep scenario
          startFlow('sleep');
          return;
        }

        errorPickFromList(t().mainMenu);
        return;
      }

      // active flow: allow internal intents too
      if (intent?.type === 'internal'){
        if (handleInternal(intent.value)) return;
      }
      if (intent?.type === 'sleepStart' && state.flow === 'sleep'){
        handleSleepText('start');
        return;
      }

      switch(state.flow){
        case 'watch': return handleWatchText(text);
        case 'sleep': return handleSleepText(text);
        case 'flyover': return handleFlyText();
        case 'aircraft': return handleAircraftText(text);
        case 'crew': return handleCrewText(text);
        default:
          resetFlow();
          errorPickFromList(t().mainMenu);
      }
    }

    // =========================
    // Send
    // =========================
    function send(){
      const text = inputEl.value.trim();
      if (!text) return;
      inputEl.value = '';
      handleUserInput(text, null);
    }
    sendEl.addEventListener('click', send);
    inputEl.addEventListener('keydown', (e)=>{ if (e.key === 'Enter') send(); });

    // =========================
    // Quick buttons
    // =========================
    crewBtnFixedEl.addEventListener('click', ()=> startFlow('crew'));

    // =========================
    // Voice note recording (MediaRecorder)
    // =========================
    const recorder = {
      supported: !!(navigator.mediaDevices && window.MediaRecorder),
      recording: false,
      mediaRecorder: null,
      chunks: [],
      stream: null
    };

    async function startRecording(){
      if (!recorder.supported){
        aeroSay(t().voice.noSupport);
        return;
      }
      try{
        recorder.stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        recorder.chunks = [];
        recorder.mediaRecorder = new MediaRecorder(recorder.stream);

        recorder.mediaRecorder.ondataavailable = (e)=>{ if (e.data && e.data.size > 0) recorder.chunks.push(e.data); };
        recorder.mediaRecorder.onstop = ()=>{
          const blob = new Blob(recorder.chunks, { type: recorder.mediaRecorder.mimeType || 'audio/webm' });
          const url = URL.createObjectURL(blob);
          addAudioMessage(url);
          aeroSay(t().voice.gotVoice, t().mainMenu);

          if (recorder.stream) recorder.stream.getTracks().forEach(tr=>tr.stop());
          recorder.stream = null;
          recorder.mediaRecorder = null;
          recorder.chunks = [];
        };

        recorder.mediaRecorder.start();
        recorder.recording = true;

        voiceBtnEl.classList.add('voice-on');
        voiceBtnEl.innerHTML = t().quick.voiceStop;
        aeroSay(t().voice.recording);
      } catch(e){
        aeroSay(t().voice.micFail);
      }
    }

    function stopRecording(){
      if (!recorder.recording) return;
      recorder.recording = false;
      try{ recorder.mediaRecorder.stop(); } catch(e) {}
      voiceBtnEl.classList.remove('voice-on');
      voiceBtnEl.innerHTML = t().quick.voice;
    }

    voiceBtnEl.addEventListener('click', ()=>{ if (!recorder.recording) startRecording(); else stopRecording(); });

    // =========================
    // Apply static texts
    // =========================
    function applyStaticTexts(){
      titleH1.textContent = t().appTitle;
      document.title = t().appTitle;

      emptyHintEl.textContent = t().emptyHint;
      inputEl.placeholder = t().placeholder;

      drawerTitle.textContent = t().drawerTitle;
      navAerofriend.textContent = t().nav.aerofriend.name;
      navAerofriendSub.textContent = t().nav.aerofriend.sub;
      navEntertainment.textContent = t().nav.entertainment.name;
      navEntertainmentSub.textContent = t().nav.entertainment.sub;
      navMap3d.textContent = t().nav.map3d.name;
      navMap3dSub.textContent = t().nav.map3d.sub;
      langTitle.textContent = t().langTitle;

      sheetTitle.textContent = t().sheetTitle;
      sheetSubtitle.textContent = t().sheetSubtitle;

      actWatchName.textContent = t().actions.watchName;
      actWatchDesc.textContent = t().actions.watchDesc;
      actSleepName.textContent = t().actions.sleepName;
      actSleepDesc.textContent = t().actions.sleepDesc;
      actFlyName.textContent = t().actions.flyName;
      actFlyDesc.textContent = t().actions.flyDesc;
      actAirName.textContent = t().actions.airName;
      actAirDesc.textContent = t().actions.airDesc;

      crewBtnFixedEl.innerHTML = `<strong>${t().quick.crew}</strong>`;
      if (!recorder.recording){
        voiceBtnEl.innerHTML = t().quick.voice;
      } else {
        voiceBtnEl.innerHTML = t().quick.voiceStop;
      }
    }

    // =========================
    // Init
    // =========================
    window.addEventListener('load', ()=>{
      // Default lang buttons
      document.querySelectorAll('.langBtn').forEach(b=>{
        b.classList.toggle('active', b.getAttribute('data-lang') === LANG);
      });
      applyStaticTexts();
      inputEl.focus();
      messagesEl.scrollTop = messagesEl.scrollHeight;
    });

    // =========================
    // Popup close
    // =========================
    // (already wired above)

  </script>
</body>
</html>







